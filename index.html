<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>cards</title>
    <link rel="stylesheet" href="./style.css">
    <script src="./script.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  </head>
  <body>
    <!-- page content -->
<script>

function dragstart_handler(ev) {
  ev.preventDefault();
  const touches = ev.changedTouches;
  const viewportOffset = ev.target.closest(".outerspan").getBoundingClientRect();
  ev.target.closest(".outerspan").setAttribute("touchstartoffset", 
    (-viewportOffset.top + touches[0].pageY)  + ',' + (-viewportOffset.left + touches[0].pageX));
}

function dragover_handler(ev) {
  ev.preventDefault();
  const touches = ev.changedTouches;
  ev.target.closest(".outerspan").style.top = 
    (touches[0].pageY - Number(ev.target.closest(".outerspan").getAttribute("touchstartoffset").split(',')[0])) + 'px';
  ev.target.closest(".outerspan").style.left = 
    (touches[0].pageX - Number(ev.target.closest(".outerspan").getAttribute("touchstartoffset").split(',')[1])) + 'px';
}

function drop_handler(ev) {
  ev.preventDefault();
}

var num = 0x1f0a0;

cardString = function (cardNum,suit,top,left) {
  var red = suit == 0x10 || suit == 0x20 ? 1 : 0; 
  return '<span class="outerspan" id="' 
    + (num+cardNum+suit).toString()  
    + '" ontouchstart="dragstart_handler(event)" ' 
    + 'style="top:' + top + 'px; left:' + left + 'px">' 
    + ((red)?'<mark class="red">':'') 
    + '<span class="innerspan">&#x' 
    + (num+cardNum+suit).toString(16) 
    + ';</span>' 
    + ((red)?'</mark>':'') 
    + '</span>';
};

window.addEventListener('load', function() {
  var strnum = cardString(0,0, 8, 7);
  for(var i=1; i<0xf; i++) {
    if(i!=0xc) {
      for(var j = 0; j < 0x40; j += 0x10) {
        strnum += cardString(i, j, 8, 7);
      }
    }
  }
  for(var i = 0; i < 7; i++) {
    strnum += cardString(0,0, 8, 7+(55 +7)*i);
  }
  for(var i = 0; i < 7; i++) {
    strnum += cardString(0,0, 8+73+8, 7+(55 +7)*i);
  }
  for(var i = 0; i < 6; i++) {
    strnum += cardString(0,0, 8+73+8+15*i, 7+(55 +7)*6);
  }
  for(var i = 1; i<0xf; i++) {
    strnum += cardString(i,0, 8+73+8+15*5 + (i-1)*15, 7+(55 +7)*6);
  }
  document.getElementById("main").innerHTML = strnum;
});

let vertGap = 15;

let horizGap = 11;
//51
// 8 73 8 7 
//8 7 94 7

</script>
<div id="main" ontouchstop="drop_handler(event)" ontouchmove="dragover_handler(event)" />
  </body>
</html>
